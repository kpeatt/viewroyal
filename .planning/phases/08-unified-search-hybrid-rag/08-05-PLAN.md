---
phase: 08-unified-search-hybrid-rag
plan: 05
type: execute
wave: 5
depends_on:
  - 08-04
files_modified: []
requirements:
  - SRCH-01
  - SRCH-02
  - SRCH-03
  - SRCH-04
  - SRCH-05
  - SRCH-06
autonomous: false
must_haves:
  truths:
    - "User can search from a single /search page"
    - "Keyword queries show ranked results from multiple content types"
    - "Question queries show streaming AI answers with citations"
    - "Follow-up questions reference previous answers"
    - "Shared URLs display cached answers"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete unified search experience end-to-end.

Purpose: Before marking Phase 8 complete, verify all requirements work in an integrated way through the development server.

Output: Verified unified search page with all SRCH requirements satisfied.
</objective>

<execution_context>
@/Users/kyle/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kyle/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-unified-search-hybrid-rag/08-04-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: Verify complete unified search experience</name>
  <files>apps/web/app/routes/search.tsx</files>
  <action>
Verify the complete unified search experience built in Plans 01-04. This is a human verification checkpoint -- no code changes needed.

What was built:
1. Unified search page (SRCH-01): Single /search page with auto-intent detection
2. Intent detection (SRCH-02): Keywords show results list, questions trigger AI answer
3. Hybrid search (SRCH-03): Results combine vector similarity and full-text search via RRF
4. Multi-content search (SRCH-04): Covers motions, key statements, document sections, transcript segments
5. Follow-up questions (SRCH-05): Conversation context carries forward
6. Session history (SRCH-06): Limited to last 5 turns, auto-clears on topic change
  </action>
  <verify>
Start the dev server: `cd apps/web && pnpm dev`

Test 1 - Unified page (SRCH-01):
1. Visit http://localhost:5173/search -- verify clean empty state with search input, example query chips
2. Visit http://localhost:5173/ask?q=test -- verify 301 redirect to /search?q=test
3. Check navbar: "Search" link instead of "Ask", no separate search icon

Test 2 - Intent detection (SRCH-02):
1. Type "bylaw 1234" and submit -- verify Search Results tab active
2. Type "What has council discussed about housing?" -- verify AI Answer tab active, streaming begins
3. Click the other tab to verify both accessible

Test 3 - Hybrid search results (SRCH-03):
1. Search "traffic safety" -- switch to Search Results tab
2. Verify results from multiple content types in single ranked list
3. Verify filter pills toggle results

Test 4 - Multi-content types (SRCH-04):
1. Search "zoning bylaw" -- verify Motions, Key Statements, Transcript segments appear
2. Note: Document sections may be empty (Phase 7.1 backfill paused) -- expected

Test 5 - AI answer quality (SRCH-02):
1. Ask "What has council decided about the new park?"
2. Verify streaming, research steps, inline citations with hover, confidence indicator, source cards

Test 6 - Follow-up questions (SRCH-05):
1. After AI answer, verify suggested follow-up chips
2. Click a chip -- verify new answer references previous context

Test 7 - Conversation memory (SRCH-06):
1. Ask question, get answer, ask follow-up -- verify context carried
2. Ask unrelated question -- verify auto-clear
3. Click "New search" -- verify full reset

Test 8 - Shareable URLs:
1. After AI answer, verify URL includes ?q=...&id=abc123
2. Open URL in new tab -- verify cached answer loads without re-generating

Test 9 - Home page integration:
1. Visit / and use hero search -- verify navigates to /search (not /ask)
  </verify>
  <done>All 9 test scenarios pass. No console errors. Streaming works. Navigation consistent with no dead /ask links. User types "approved" to confirm.</done>
</task>

</tasks>

<verification>
All SRCH-01 through SRCH-06 requirements verified through manual testing.
</verification>

<success_criteria>
- All 9 test scenarios pass
- No console errors during normal usage
- Streaming works without interruption
- Navigation is consistent (no dead /ask links)
</success_criteria>

<output>
After completion, create `.planning/phases/08-unified-search-hybrid-rag/08-05-SUMMARY.md`
</output>
